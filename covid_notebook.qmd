---
title: "___"
author: "Azizi Moussa, Dezutter Joy, Fernandez Dany, Fontaine Maréva"
format:
  html:
    code-fold: true
    code-tools: true
    toc: true
editor: visual
lang: fr
---

<!--# Ceci est un commentaire. -->

<!--% Ceci est une consigne. Ne jamais modifier ni déplacer les consignes dans le document ! -->

<!--% Complétez le titre et le nom des auteurs (auteur1, auteur2, auteur3 et auteur 4) dans l'entête YAML.-->

## Introduction et but

<!--% Rédigez une courte introduction de 3 ou 5 phrases qui présente vos données. Ajoutez une phrase de but. Vous devez citer la bibliographie en utilisant le formatage Markdown ad hoc et en incluant votre référence au format bibtex dans le fichier references.bib. -->

Google répertorie les données sur la mobilité des communautés pendant le COVID-19 (elles ne sont plus répertoriés depuis le 15/10/2022), celles-ci sont disponibles ici : https://www.google.com/covid19/mobility/
Nous allons analyser ces données en nous concentrant sur les années 2020 et 2021, l'année 2020 ayant été fortement impactée au niveau économique notamment due aux règles au niveau des déplacements et l'année 2021 également mais ayant subit des mesures moins "strictes".
Notre objectif est de déterminer l'impact du COVID-19 sur les déplacements des Wallons, pour ce faire nous allons analyser l'évolution de la fréquentation de lieux au cours du temps et également par catégorie (commerces, pharmacies, parcs, lieux de travail,...)

## Matériel et méthodes

<!--% Indiquez ici d'où viennent les données et aussi quel logiciel (et version) vous utilisez pour les analyses. Inspirez-vous des projets déjà réalisés. -->

Les données sur les divers déplacements proviennent de Google

## Analyses

<!--% Lisez bien les éléments devant guider votre analyse proposée dans le README.-->

```{r setup, include=FALSE}
# Nécessaire pour les tests SDD, ne pas utiliser dans un "vrai" projet
if (!"tools:tests" %in% search())
  source(here::here("tests/tools_tests.R"), attach(NULL, name = "tools:tests"))
# Configuration de l'environnement
SciViews::R("ts", lang="fr")
```

<!--% Ajoutez le nombre de chunks que vous souhaitez. Répartissez-vous le travail correctement. Structurez la section en partie avec des titres explicites de niveau trois.-->

```{r}
mobility <- read("data/mobility_wallonia.rds")
mobility <- labelise(mobility,
  label= list(
  retail_and_recreation_percent_change_from_baseline = "commerces_loisirs", 
  grocery_and_pharmacy_percent_change_from_baseline = "alimentation_pharmacies", 
  parks_percent_change_from_baseline = "parcs" ,
  transit_stations_percent_change_from_baseline = "arrets transports",
  workplaces_percent_change_from_baseline = "travail",
  residential_percent_change_from_baseline ="residence"))
mobility<- rename(mobility,
  commerces_loisirs = "retail_and_recreation_percent_change_from_baseline",
  alimentation_pharmacies = "grocery_and_pharmacy_percent_change_from_baseline",
  parcs = "parks_percent_change_from_baseline",
  arrets_transports = "transit_stations_percent_change_from_baseline",
  travail = "workplaces_percent_change_from_baseline",
  residence = "residential_percent_change_from_baseline")
```

```{r}
mobility_tsbl <- tsibble::as_tsibble(mobility)
mobility_tsbl
```


```{r skim Maréva}
skimr::skim(mobility)
```

```{r Maréva} 
sdrop_na(mobility) -> mobility
```

```{r ts Maréva}
mobility_com_ts <- ts(mobility$commerces_loisirs, start=1, end=972 ,frequency=365)
plot(mobility_com_ts)

acf_com <- acf(mobility_com_ts)

mobility_com_trend <- trend.test(mobility_com_ts, R=999)
plot(mobility_com_trend)

mobility_com_loess <- tsd(mobility_com_ts, method="loess", s.window=13, trend=TRUE)
plot(mobility_com_loess, col=1:4)

mobility_com_spec <- spectrum(extract(mobility_com_loess, components="trend"), spans=c(3,5))
```

```{r ts Maréva}

```

```{r #joy} 
mobility_grocery_pharma_ts <- ts(mobility$grocery_and_pharmacy_percent_change_from_baseline, start=2020, frequency=365)
plot(mobility_grocery_pharma_ts)

acf_grocery_pharma <- acf(mobility_grocery_pharma_ts)

mobility_grocery_pharma_trend <- trend.test(mobility_grocery_pharma_ts, R=999)
plot(mobility_grocery_pharma_trend)

mobility_grocery_pharma_loess <- tsd(mobility_grocery_pharma_ts, method="loess", s.window=13, trend=TRUE)
plot(mobility_grocery_pharma_loess, col=1:4)

mobility_grocery_pharma_spec <- spectrum(extract(mobility_grocery_pharma_loess, components="trend"), spans=c(3,5))
```


```{r #joy} 
mobility_parks_ts <- ts(mobility$parks_percent_change_from_baseline, start=2020, frequency=365)
plot(mobility_parks_ts)

acf_parks <- acf(mobility_parks_ts)

mobility_parks_trend <- trend.test(mobility_parks_ts, R=999)
plot(mobility_parks_trend)

mobility_parks_loess <- tsd(mobility_parks_ts, method="loess", s.window=13, trend=TRUE)
plot(mobility_parks_loess, col=1:4)

mobility_parks_spec <- spectrum(extract(mobility_parks_loess, components="trend"), spans=c(3,5))
```

```{r #joy} 
mobility_parks_ts <- ts(mobility$parks_percent_change_from_baseline, start=2020, frequency=365)
plot(mobility_parks_ts)

acf_parks <- acf(mobility_parks_ts)

mobility_parks_trend <- trend.test(mobility_parks_ts, R=999)
plot(mobility_parks_trend)

mobility_parks_loess <- tsd(mobility_parks_ts, method="loess", s.window=13, trend=TRUE)
plot(mobility_parks_loess, col=1:4)

mobility_parks_spec <- spectrum(extract(mobility_parks_loess, components="trend"), spans=c(3,5))
```
## Conclusion

<!--% Lorsque toutes les analyses sont réalisées, terminez ce bloc-notes avec 3 à 6 phrases de conclusion en rapport avec ce que vous avez observé dans vos analyses. Quels sont les éléments les plus pertinents que vous retenez ? -->

...vos conclusions ici...
